-- Eliminar la tabla registro_planilla_pst
DROP TABLE registro_planilla_pst;

-- Eliminar la tabla planillas_pst
DROP TABLE planillas_pst;

-- Eliminar la tabla usuarios
DROP TABLE dbo.usuarios_pst;


CREATE TABLE planillas_pst (
    cod_planilla smallint PRIMARY KEY IDENTITY(1,1),
    cod_lote bigint,
    fec_turno datetime,
    cod_turno smallint,
    cod_empresa numeric(18,0),
    cod_especie smallint,
    cod_planillera numeric(18,0),
    cod_supervisor numeric(18,0),
    guardado numeric(18,0),
    UNIQUE(cod_planilla) 
);

CREATE TABLE registro_planilla_pst 
(
    cod_reg smallint PRIMARY KEY IDENTITY(1,1),
    cod_planilla smallint,
    cod_corte_ini bigint,
    cod_corte_fin bigint,
    cod_proceso numeric(18,0),
    cod_calibre smallint,
    cod_calidad smallint,
    piezas numeric(18,0),
    kilos float,
    guardado numeric(18,0),	
    FOREIGN KEY (cod_planilla) REFERENCES planillas_pst(cod_planilla)
);


-- Crear la tabla de usuarios
CREATE TABLE dbo.usuarios_pst (
    cod_usuario INT PRIMARY KEY IDENTITY(1,1),
    nombre_usuario NVARCHAR(255),
    pass NVARCHAR(255),
    rol_supervisor numeric(18,0),
	rol_admin numeric(18,0)
);

-- Insertar datos de ejemplo en la tabla de usuarios
INSERT INTO dbo.usuarios_pst (nombre_usuario, pass, rol_supervisor,rol_admin)
VALUES
    ('juan_perez', '123', 1,0),   -- Supervisor
    ('maria_gomez', '123', 0,0),  -- Planillera
    ('carla_rodriguez', '123', 0,0),  -- Planillera
    ('ana_martinez', '123', 1,0),  -- Supervisor
    ('luis_sanchez', '123', 0,0),  -- Planillero
	('admin','admin',0,1); -- Admin


INSERT INTO planillas_pst (cod_lote, fec_turno, cod_turno, cod_empresa, cod_especie, cod_planillera, cod_supervisor, guardado)
VALUES (
    194133,                 -- cod_lote
    '2024-01-12 08:00:00', -- fec_turno
    1,                   -- cod_turno
    77,              -- cod_empresa
    161,                   -- cod_especie
    5,              -- cod_planillera
    1,              -- cod_supervisor
    1                    -- guardado
);

INSERT INTO planillas_pst (cod_lote, fec_turno, cod_turno, cod_empresa, cod_especie, cod_planillera, cod_supervisor, guardado)
VALUES (
    157313,                 -- cod_lote
    '2024-01-12 08:00:00', -- fec_turno
    2,                   -- cod_turno
    23,              -- cod_empresa
    1,                   -- cod_especie
    5,              -- cod_planillera
    1,              -- cod_supervisor
    1                    -- guardado
);
